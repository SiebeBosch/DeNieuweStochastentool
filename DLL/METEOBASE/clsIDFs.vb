Imports STOCHLIB.General
Public Class clsIDFs
    Private Setup As clsSetup
    Dim IDFs As New Dictionary(Of String, clsIDF)
    Public Sub New(ByRef mySetup As clsSetup)
        Setup = mySetup
    End Sub

    Public Function CalculateFromSTOWA2019(Year As GeneralFunctions.enmSTOWA2019ScenarioYear, Scenario As GeneralFunctions.enmSTOWA2019Scenario, Season As GeneralFunctions.enmSTOWA2019Season, SurfaceAreakm2 As Double) As Boolean
        Try
            'here we implement our translated version of the R-scripts by Aart Overeem. 

            'start by defining our durations
            Dim DurationHours As New List(Of Double)
            DurationHours.Add(0.25)
            DurationHours.Add(0.5)
            DurationHours.Add(1)
            DurationHours.Add(2)
            DurationHours.Add(4)
            DurationHours.Add(8)
            DurationHours.Add(12)
            DurationHours.Add(24)
            DurationHours.Add(48)
            DurationHours.Add(96)
            DurationHours.Add(192)
            DurationHours.Add(216)

            'then the area in square km. notice that the unit is 5.73 km2. This represents one radar pixel
            Dim Area As New List(Of Double)
            Area.Add(1 * 5.73)
            Area.Add(3 ^ 2 * 5.73)
            Area.Add(5 ^ 2 * 5.73)
            Area.Add(7 ^ 2 * 5.73)
            Area.Add(9 ^ 2 * 5.73)
            Area.Add(11 ^ 2 * 5.73)
            Area.Add(13 ^ 2 * 5.73)
            Area.Add(15 ^ 2 * 5.73)
            Area.Add(17 ^ 2 * 5.73)

            'now create an array for each of the GEV parameters
            Dim loc As Double(,)
            Dim disp As Double(,)
            Dim kappa As Double(,)
            PopulateGEVParsFromSTOWA2019(loc, disp, kappa)






            Return True
        Catch ex As Exception
            Return False
        End Try
    End Function

    Public Function PopulateGEVParsFromSTOWA2019(ByRef loc As Double(,), ByRef scale As Double(,), ByRef shape As Double(,)) As Boolean

        'start with the 9 days values
        '"Site;years;locpar_LM;sclpar_LM;k_LM;CV_LM"
        Dim Block9D As New List(Of String)
        Dim Block8D As New List(Of String)
        Dim Block4D As New List(Of String)
        Dim Block2D As New List(Of String)
        Dim Block1D As New List(Of String)
        Dim Block12H As New List(Of String)
        Dim Block8H As New List(Of String)
        Dim Block4H As New List(Of String)
        Dim Block2H As New List(Of String)
        Dim Block1H As New List(Of String)
        Dim Block30M As New List(Of String)
        Dim Block15M As New List(Of String)

        Block9D.Add("1 pixel;117610;74.1239158516677;16.1198061395207;-0.0512522408942082;0.217471054440495")
        Block9D.Add("9 pixels;96957;73.7329050681309;15.7059336898081;-0.0458452704818572;0.213011187817643")
        Block9D.Add("25 pixels;81434;73.2583441622298;15.3402795229841;-0.0415688112727007;0.209399757780673")
        Block9D.Add("49 pixels;69084;72.75705086347;14.9568446446211;-0.0389557533067463;0.205572442355971")
        Block9D.Add("81 pixels;59071;72.2410172767708;14.5738293464359;-0.0366930817566132;0.201738982863439")
        Block9D.Add("121 pixels;50084;71.6913458109891;14.1635066743173;-0.0378007973080677;0.197562293106601")
        Block9D.Add("169 pixels;42047;71.1933316799655;13.7694562929812;-0.0412919325797747;0.193409354051288")
        Block9D.Add("225 pixels;34884;70.8448529796266;13.4609153977979;-0.045498437512225;0.190005552014752")
        Block9D.Add("289 pixels;28063;70.5565217418994;13.1894773758818;-0.0499499102107633;0.186934914735874")

        Block8D.Add("1 pixel;117610;70.1872119340305;15.4154821977777;-0.060505168263816;0.219633773347014")
        Block8D.Add("9 pixels;96957;69.7420298803996;15.0136835218905;-0.0546804052018978;0.215274541730967")
        Block8D.Add("25 pixels;81434;69.2493618437318;14.6328530807044;-0.0513837362529452;0.211306684872056")
        Block8D.Add("49 pixels;69084;68.7564890232306;14.2301428678774;-0.0498597169175864;0.206964361764742")
        Block8D.Add("81 pixels;59071;68.2619561793752;13.8322501868761;-0.048495637746028;0.202634834409498")
        Block8D.Add("121 pixels;50084;67.7185375418625;13.4149510181542;-0.0513958478694518;0.198098652231839")
        Block8D.Add("169 pixels;42047;67.217164238321;13.0245670958287;-0.0572061442164475;0.193768470351555")
        Block8D.Add("225 pixels;34884;66.8679554043205;12.6964089029675;-0.0646012036002722;0.18987284456655")
        Block8D.Add("289 pixels;28063;66.5753674772188;12.3645553134078;-0.074572630413224;0.185722674645976")

        Block4D.Add("1 pixel;117610;51.5226619550072;12.4207093706914;-0.118373844938239;0.241072741574144")
        Block4D.Add("9 pixels;96957;51.0704987778862;12.1027994189244;-0.112543981283232;0.23698220515843")
        Block4D.Add("25 pixels;81434;50.5668568967305;11.7792150186861;-0.110052744226073;0.232943389041207")
        Block4D.Add("49 pixels;69084;50.074362055797;11.474692189488;-0.110412309798056;0.22915303796985")
        Block4D.Add("81 pixels;59071;49.6046604727027;11.2308870718641;-0.108175486217544;0.226407901290734")
        Block4D.Add("121 pixels;50084;49.1433740461701;11.0224998455835;-0.106691835063473;0.224292695801226")
        Block4D.Add("169 pixels;42047;48.7405579514312;10.8385305040521;-0.104118385624191;0.222371900519736")
        Block4D.Add("225 pixels;34884;48.4306594877267;10.6612101121665;-0.102712102860235;0.220133490333087")
        Block4D.Add("289 pixels;28063;48.141460564565;10.4367333362928;-0.106785855808423;0.216793034816539")

        Block2D.Add("1 pixel;117610;41.9004197187678;10.0433611183503;-0.16581365221165;0.239695954975164")
        Block2D.Add("9 pixels;96957;41.4011403042835;9.68953833613133;-0.16266779043278;0.234040373403165")
        Block2D.Add("25 pixels;81434;40.8747607670408;9.32938097154997;-0.162862893446567;0.228243072166741")
        Block2D.Add("49 pixels;69084;40.3617920247273;8.99295272942037;-0.168583707983155;0.222808559241149")
        Block2D.Add("81 pixels;59071;39.8917306628043;8.7346747550457;-0.171198675915258;0.218959533966523")
        Block2D.Add("121 pixels;50084;39.4480199592926;8.50505431831376;-0.174393146965155;0.215601551791201")
        Block2D.Add("169 pixels;42047;39.0678101926059;8.30094135387385;-0.175302668486457;0.212475214580748")
        Block2D.Add("225 pixels;34884;38.7773123038217;8.13778501314935;-0.173779622424461;0.209859439184168")
        Block2D.Add("289 pixels;28063;38.5264397374482;7.97523982330591;-0.173286380740916;0.207006925053442")

        Block1D.Add("1 pixel;117610;34.136582266701;8.48992849504951;-0.190316759742033;0.248704701270904")
        Block1D.Add("9 pixels;96957;33.5992754331044;8.11148256025994;-0.192502372266216;0.241418377500722")
        Block1D.Add("25 pixels;81434;33.0760957702847;7.77806118908848;-0.194549482350984;0.235156568753082")
        Block1D.Add("49 pixels;69084;32.5960880037195;7.49063779528556;-0.197776422041316;0.22980174168234")
        Block1D.Add("81 pixels;59071;32.1209622260836;7.23125533815616;-0.201510106651065;0.225125738365461")
        Block1D.Add("121 pixels;50084;31.671209684885;7.03687741384064;-0.20062059486348;0.222185305956247")
        Block1D.Add("169 pixels;42047;31.2787050596421;6.89438799675961;-0.193381063023804;0.22041794836498")
        Block1D.Add("225 pixels;34884;30.969570958488;6.79641317871125;-0.183561465189088;0.219454547427255")
        Block1D.Add("289 pixels;28063;30.696169180035;6.71708418573438;-0.173429803570496;0.218824835970191")

        Block12H.Add("1 pixel;117610;28.5751072514721;7.32996226167805;-0.191121620622388;0.256515651793413")
        Block12H.Add("9 pixels;96957;28.0414864406803;6.92367399680706;-0.195092766324782;0.24690823760194")
        Block12H.Add("25 pixels;81434;27.570183546931;6.59804234266047;-0.191492342802146;0.239318041950248")
        Block12H.Add("49 pixels;69084;27.1546516004664;6.33417348625882;-0.18473148862316;0.233262925978768")
        Block12H.Add("81 pixels;59071;26.75410806539;6.07073510289352;-0.179518976394131;0.226908521414953")
        Block12H.Add("121 pixels;50084;26.3717275851971;5.8285122648216;-0.174391902624955;0.221013668747786")
        Block12H.Add("169 pixels;42047;26.0244143114607;5.62578103038035;-0.164196101952651;0.216173204247784")
        Block12H.Add("225 pixels;34884;25.7333904730299;5.4768762666372;-0.150030730964239;0.212831506690783")
        Block12H.Add("289 pixels;28063;25.4691444922108;5.34480986036999;-0.135688588347242;0.209854314580711")

        Block8H.Add("1 pixel;117610;25.4984238527503;6.63814160762999;-0.188177488285709;0.260335369980682")
        Block8H.Add("9 pixels;96957;24.9376842328987;6.2517707612089;-0.190904779857454;0.250695722298117")
        Block8H.Add("25 pixels;81434;24.4390612761673;5.94586345235306;-0.187364433003022;0.243293446714805")
        Block8H.Add("49 pixels;69084;24.0217782949645;5.70437183507096;-0.177712506948985;0.237466675656844")
        Block8H.Add("81 pixels;59071;23.6395489925322;5.45963088150022;-0.167341719630605;0.230953259016275")
        Block8H.Add("121 pixels;50084;23.2729032573903;5.2368053867251;-0.155354592677637;0.225017279915954")
        Block8H.Add("169 pixels;42047;22.9312157399957;5.02319478874797;-0.141234654771305;0.219054883339077")
        Block8H.Add("225 pixels;34884;22.6262837043886;4.85003729570501;-0.125890075342847;0.214354127220826")
        Block8H.Add("289 pixels;28063;22.3407249837604;4.68084667712355;-0.112837615794725;0.209520804742285")

        Block4H.Add("1 pixel;117610;20.5924110465457;5.63391667453638;-0.175338440062201;0.273591890808796")
        Block4H.Add("9 pixels;96957;19.9950944517894;5.27570860234007;-0.169778160870852;0.263850146597729")
        Block4H.Add("25 pixels;81434;19.433331900897;4.98628079302675;-0.163822355951894;0.256583936221282")
        Block4H.Add("49 pixels;69084;18.9377349488511;4.75552955239209;-0.159646064229244;0.251113956618164")
        Block4H.Add("81 pixels;59071;18.5066339713206;4.55879142993647;-0.151064850033211;0.246332825137254")
        Block4H.Add("121 pixels;50084;18.1030219173478;4.37508861754263;-0.143998686682755;0.241677253528045")
        Block4H.Add("169 pixels;42047;17.738765450445;4.20641197449785;-0.133265160323314;0.237131044223392")
        Block4H.Add("225 pixels;34884;17.4354020534288;4.06054960045783;-0.11648130087866;0.232891079197069")
        Block4H.Add("289 pixels;28063;17.1621611476945;3.90468670462041;-0.0994474016655955;0.227517191513201")

        Block2H.Add("1 pixel;117610;16.7704942642987;4.90845293340405;-0.176262468754872;0.292683856304298")
        Block2H.Add("9 pixels;96957;16.0368037795387;4.47632836121955;-0.162617080697623;0.279128461179457")
        Block2H.Add("25 pixels;81434;15.381186895456;4.14218395662763;-0.147080445986701;0.269301971608663")
        Block2H.Add("49 pixels;69084;14.8237031567731;3.87337169101183;-0.131448473224354;0.261295821296992")
        Block2H.Add("81 pixels;59071;14.3451049633338;3.65097650356868;-0.110252512485808;0.254510267641862")
        Block2H.Add("121 pixels;50084;13.9223073450949;3.45426989247272;-0.0866633366707748;0.248110446555378")
        Block2H.Add("169 pixels;42047;13.539268902388;3.26833185993273;-0.0630680537980209;0.241396480378367")
        Block2H.Add("225 pixels;34884;13.1932505021018;3.10164107029804;-0.03755717414805;0.235093017433718")
        Block2H.Add("289 pixels;28063;12.8705996322783;2.94198384227863;-0.0119834876493325;0.228581723177871")

        Block1H.Add("1 pixel;117610;13.218049837703;4.18387789644685;-0.169686674919718;0.316527623047147")
        Block1H.Add("9 pixels;96957;12.3188911160318;3.67851666737384;-0.142810043113753;0.298607775060746")
        Block1H.Add("25 pixels;81434;11.5328027927596;3.2666265018585;-0.117942886440903;0.28324654124055")
        Block1H.Add("49 pixels;69084;10.8701551239488;2.94143264206879;-0.0996642626564461;0.270597117385042")
        Block1H.Add("81 pixels;59071;10.2973312132505;2.67289264870716;-0.085529043377726;0.259571397030302")
        Block1H.Add("121 pixels;50084;9.80095639203887;2.44082953311646;-0.0741324815424861;0.249039934010838")
        Block1H.Add("169 pixels;42047;9.34720017624355;2.24229901594163;-0.0670411710749044;0.239889910739321")
        Block1H.Add("225 pixels;34884;8.94202829167071;2.08897820910422;-0.0570674742837164;0.233613464525722")
        Block1H.Add("289 pixels;28063;8.57002673754884;1.96821574746702;-0.0429331788392205;0.229662731254204")

        Block30M.Add("1 pixel;117610;10.4546551438572;3.53615536438155;-0.133557989496117;0.338237399103431")
        Block30M.Add("9 pixels;96957;9.33020236014733;2.98023126319651;-0.0956040791114591;0.319417644779727")
        Block30M.Add("25 pixels;81434;8.3733217409595;2.56391908477116;-0.0663877643646879;0.306200951556576")
        Block30M.Add("49 pixels;69084;7.60102463965611;2.24988942648773;-0.0464676578408127;0.295998175660371")
        Block30M.Add("81 pixels;59071;6.95852398653494;1.98107786475107;-0.0410218822608488;0.284698000407061")
        Block30M.Add("121 pixels;50084;6.4039461161634;1.75365035671569;-0.0496148614421001;0.273839024393026")
        Block30M.Add("169 pixels;42047;5.91926666648388;1.57163423060632;-0.0618518454390864;0.265511645134226")
        Block30M.Add("225 pixels;34884;5.50482619119558;1.42974230155107;-0.0703468304725661;0.259725239615703")
        Block30M.Add("289 pixels;28063;5.15181217792647;1.31530336553894;-0.0746721453601331;0.25530887387054")

        Block15M.Add("1 pixel;117610;7.99601641257175;2.76230071131555;-0.0990140162497294;0.345459609984356")
        Block15M.Add("9 pixels;96957;6.61733409113894;2.18011417317504;-0.0725296789340225;0.329455055940785")
        Block15M.Add("25 pixels;81434;5.55435065517195;1.78604722770556;-0.0670775491160267;0.321558241203672")
        Block15M.Add("49 pixels;69084;4.76785769613192;1.48595909109105;-0.0706138017798152;0.311661795673261")
        Block15M.Add("81 pixels;59071;4.16597491995785;1.2479647417624;-0.0835571279541525;0.299561270948559")
        Block15M.Add("121 pixels;50084;3.70149950934942;1.0669212833413;-0.0999319728387095;0.288240287658128")
        Block15M.Add("169 pixels;42047;3.34057373946442;0.933429304010456;-0.110177688433509;0.27942185289408")
        Block15M.Add("225 pixels;34884;3.05698484788124;0.835991736343779;-0.113226502553864;0.27346937519929")
        Block15M.Add("289 pixels;28063;2.82968125249177;0.760999104054734;-0.110952299091445;0.26893456758941")

        Dim myBlock As New List(Of String)
        Dim myString As String
        Dim myStr As String
        ReDim loc(11, 8)            'redim to 12 durations and 9 areas
        ReDim scale(11, 8)          'redim to 12 durations and 9 areas
        ReDim shape(11, 8)          'redim to 12 durations and 9 areas
        'cycle through the durations
        For d = 0 To 11
            Select Case d
                Case 0
                    myBlock = Block15M
                Case 1
                    myBlock = Block30M
                Case 2
                    myBlock = Block1H
                Case 3
                    myBlock = Block2H
                Case 4
                    myBlock = Block4H
                Case 5
                    myBlock = Block8H
                Case 6
                    myBlock = Block12H
                Case 7
                    myBlock = Block1D
                Case 8
                    myBlock = Block2D
                Case 9
                    myBlock = Block4D
                Case 10
                    myBlock = Block8D
                Case 11
                    myBlock = Block9D
            End Select
            'cycle through the areas
            For a = 0 To 8
                myString = myBlock(a)
                For i = 0 To 4
                    myStr = Setup.GeneralFunctions.ParseString(";")
                    If i = 2 Then
                        loc(d, a) = Val(myStr)
                    ElseIf i = 3 Then
                        scale(d, a) = Val(myStr)
                    ElseIf i = 4 Then
                        shape(d, a) = Val(myStr)
                    End If
                Next
            Next
        Next



    End Function


End Class
